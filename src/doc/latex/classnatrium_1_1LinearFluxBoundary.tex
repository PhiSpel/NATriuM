\hypertarget{classnatrium_1_1LinearFluxBoundary}{
\section{natrium::LinearFluxBoundary$<$ dim $>$ Class Template Reference}
\label{classnatrium_1_1LinearFluxBoundary}\index{natrium::LinearFluxBoundary@{natrium::LinearFluxBoundary}}
}


Abstract class to describe Linear boundary conditions. The virtual function to be overriden is assembleBoundary. Moreover, the DoF couplings at the boundary have to be defined (see Documentation of the constructors).  


{\ttfamily \#include $<$LinearFluxBoundary.h$>$}Inheritance diagram for natrium::LinearFluxBoundary$<$ dim $>$::\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=3cm]{classnatrium_1_1LinearFluxBoundary}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classnatrium_1_1LinearFluxBoundary_a11da5c0871a45ec24aa7fa2d0e3843d9}{LinearFluxBoundary} (size\_\-t boundaryIndicator, boost::shared\_\-ptr$<$ dealii::Function$<$ dim $>$ $>$ boundaryDensity, boost::shared\_\-ptr$<$ dealii::Function$<$ dim $>$ $>$ boundaryVelocity, BoundaryTools::DistributionCouplingAtBoundary distribution\_\-coupling, BoundaryTools::PointCouplingAtBoundary point\_\-coupling)
\item 
\hypertarget{classnatrium_1_1LinearFluxBoundary_a672e96b41b39f6b77faf7811a981f794}{
virtual \hyperlink{classnatrium_1_1LinearFluxBoundary_a672e96b41b39f6b77faf7811a981f794}{$\sim$LinearFluxBoundary} ()}
\label{classnatrium_1_1LinearFluxBoundary_a672e96b41b39f6b77faf7811a981f794}

\begin{DoxyCompactList}\small\item\em destructor \item\end{DoxyCompactList}\item 
virtual void \hyperlink{classnatrium_1_1LinearFluxBoundary_a9af705258aaaa468de303848f622f9c0}{addToSparsityPattern} (dealii::TrilinosWrappers::SparsityPattern \&cSparse, const dealii::DoFHandler$<$ dim $>$ \&doFHandler) const 
\begin{DoxyCompactList}\small\item\em In order to include the boundary conditions into the integration we have to expand the sparsity pattern. In concrete, we have to couple blocks at the boundary that belong to different distribution functions \[ f_{\alpha} \] and \[ f_{\beta} \]. The concrete coupling depends on m\_\-pointCoupling. If this is
\begin{DoxyItemize}
\item COUPLE\_\-ONLY\_\-SINGLE\_\-POINTS: only the DoFs belonging to the same point are coupled
\item COUPLE\_\-WHOLE\_\-FACE: all DoFs at the face are coupled, e.g. if \[ \partial_{x}f_{\beta} \] is required to calculate \[ f_{\alpha} \] at the boundary. 
\end{DoxyItemize}\item\end{DoxyCompactList}\item 
virtual void \hyperlink{classnatrium_1_1LinearFluxBoundary_a0b050ff4bc9204ae732fec318c21cf2b}{assembleBoundary} (size\_\-t alpha, const typename dealii::DoFHandler$<$ dim $>$::active\_\-cell\_\-iterator \&cell, size\_\-t faceNumber, dealii::FEFaceValues$<$ dim $>$ \&feFaceValues, const \hyperlink{classnatrium_1_1Stencil}{Stencil} \&stencil, const std::map$<$ size\_\-t, size\_\-t $>$ \&q\_\-index\_\-to\_\-facedof, const vector$<$ double $>$ \&inverseLocalMassMatrix, distributed\_\-sparse\_\-block\_\-matrix \&systemMatrix, distributed\_\-block\_\-vector \&systemVector, bool useCentralFlux=false) const =0
\begin{DoxyCompactList}\small\item\em Pure virtual function for the concrete assembly of the boundary. The child classes have to override this function for each specific boundary. \item\end{DoxyCompactList}\item 
\hypertarget{classnatrium_1_1LinearFluxBoundary_a9d47c42f58d8856ce1e626b1b33b9af1}{
size\_\-t {\bfseries getBoundaryIndicator} () const }
\label{classnatrium_1_1LinearFluxBoundary_a9d47c42f58d8856ce1e626b1b33b9af1}

\item 
\hypertarget{classnatrium_1_1LinearFluxBoundary_a6e1ab8aa7ece5c165e36363e81c5b521}{
const boost::shared\_\-ptr$<$ dealii::Function$<$ dim $>$ $>$ \& {\bfseries getBoundaryDensity} () const }
\label{classnatrium_1_1LinearFluxBoundary_a6e1ab8aa7ece5c165e36363e81c5b521}

\item 
\hypertarget{classnatrium_1_1LinearFluxBoundary_ab631d4d94882bb2a29002498d2ddb34c}{
const boost::shared\_\-ptr$<$ dealii::Function$<$ dim $>$ $>$ \& {\bfseries getBoundaryVelocity} () const }
\label{classnatrium_1_1LinearFluxBoundary_ab631d4d94882bb2a29002498d2ddb34c}

\item 
\hypertarget{classnatrium_1_1LinearFluxBoundary_ad13f51e17a0fb420ef8d6d090af73b34}{
virtual bool \hyperlink{classnatrium_1_1LinearFluxBoundary_ad13f51e17a0fb420ef8d6d090af73b34}{isLinear} () const }
\label{classnatrium_1_1LinearFluxBoundary_ad13f51e17a0fb420ef8d6d090af73b34}

\begin{DoxyCompactList}\small\item\em is the boundary a dirichlet boundary ? \item\end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
\hypertarget{classnatrium_1_1LinearFluxBoundary_a43cb1a741dedeef2b4bb190b01276806}{
const BoundaryTools::DistributionCouplingAtBoundary {\bfseries m\_\-distributionCoupling}}
\label{classnatrium_1_1LinearFluxBoundary_a43cb1a741dedeef2b4bb190b01276806}

\item 
\hypertarget{classnatrium_1_1LinearFluxBoundary_ab94f9bae96855ffc67e7b8f1745fecd4}{
const BoundaryTools::PointCouplingAtBoundary {\bfseries m\_\-pointCoupling}}
\label{classnatrium_1_1LinearFluxBoundary_ab94f9bae96855ffc67e7b8f1745fecd4}

\end{DoxyCompactItemize}


\subsection{Detailed Description}
\subsubsection*{template$<$size\_\-t dim$>$ class natrium::LinearFluxBoundary$<$ dim $>$}

Abstract class to describe Linear boundary conditions. The virtual function to be overriden is assembleBoundary. Moreover, the DoF couplings at the boundary have to be defined (see Documentation of the constructors). 

\subsection{Constructor \& Destructor Documentation}
\hypertarget{classnatrium_1_1LinearFluxBoundary_a11da5c0871a45ec24aa7fa2d0e3843d9}{
\index{natrium::LinearFluxBoundary@{natrium::LinearFluxBoundary}!LinearFluxBoundary@{LinearFluxBoundary}}
\index{LinearFluxBoundary@{LinearFluxBoundary}!natrium::LinearFluxBoundary@{natrium::LinearFluxBoundary}}
\subsubsection[{LinearFluxBoundary}]{\setlength{\rightskip}{0pt plus 5cm}template$<$size\_\-t dim$>$ {\bf natrium::LinearFluxBoundary}$<$ dim $>$::{\bf LinearFluxBoundary} (size\_\-t {\em boundaryIndicator}, \/  boost::shared\_\-ptr$<$ dealii::Function$<$ dim $>$ $>$ {\em boundaryDensity}, \/  boost::shared\_\-ptr$<$ dealii::Function$<$ dim $>$ $>$ {\em boundaryVelocity}, \/  BoundaryTools::DistributionCouplingAtBoundary {\em distribution\_\-coupling}, \/  BoundaryTools::PointCouplingAtBoundary {\em point\_\-coupling})\hspace{0.3cm}{\ttfamily  \mbox{[}inline\mbox{]}}}}
\label{classnatrium_1_1LinearFluxBoundary_a11da5c0871a45ec24aa7fa2d0e3843d9}
Constructor 
\begin{DoxyParams}{Parameters}
\item[\mbox{$\leftarrow$} {\em boundaryIndicator}]the boundary indicator that is assigned to the target boundary. \item[\mbox{$\leftarrow$} {\em boundaryDensity}]A dealii::Function$<$dim$>$ that defines the prescribed density at the boundary. \item[\mbox{$\leftarrow$} {\em boundaryVelocity}]A dealii::Function$<$dim$>$ that defines the prescribed velocity at the boundary. \item[\mbox{$\leftarrow$} {\em distribution\_\-coupling}]Indicates which distributions are coupled at the boundary. There are two possibilities:
\begin{DoxyEnumerate}
\item $\backslash$\mbox{[} f\_\-\{\} \mbox{]} depends only on the opposite distribution function $\backslash$\mbox{[} f\_\-\{$^\wedge$\{\}\} \mbox{]}. Then this parameter has to be COUPLE\_\-ONLY\_\-OPPOSITE\_\-DISTRIBUTIONS.
\item $\backslash$\mbox{[} f\_\-\{\} \mbox{]} depens on all distribution functions (e.g. when the density or velocity is used for the boundary condition (the calculated on, not the prescribed one). Then, this parameter has to be COUPLE\_\-ALL\_\-DISTRIBUTIONS. 
\end{DoxyEnumerate}\item[\mbox{$\leftarrow$} {\em point\_\-coupling}]Indicates which DoFs are coupled at the boundary. There are two cases:
\begin{DoxyEnumerate}
\item $\backslash$\mbox{[} f\_\-\{\} \mbox{]} depends only on the distribution functions at a given point (and possibly some other data, but no distribution functions at other points). Then, this parameter has to be COUPLE\_\-ONLY\_\-SINGLE\_\-POINTS.
\item $\backslash$\mbox{[} f\_\-\{\} \mbox{]} depends on the distribution functions at other points at the face (e.g. when gradients are computed.) Then, this parameter has to be COUPLE\_\-WHOLE\_\-FACE. 
\end{DoxyEnumerate}\end{DoxyParams}


\subsection{Member Function Documentation}
\hypertarget{classnatrium_1_1LinearFluxBoundary_a9af705258aaaa468de303848f622f9c0}{
\index{natrium::LinearFluxBoundary@{natrium::LinearFluxBoundary}!addToSparsityPattern@{addToSparsityPattern}}
\index{addToSparsityPattern@{addToSparsityPattern}!natrium::LinearFluxBoundary@{natrium::LinearFluxBoundary}}
\subsubsection[{addToSparsityPattern}]{\setlength{\rightskip}{0pt plus 5cm}template$<$size\_\-t dim$>$ void {\bf natrium::LinearFluxBoundary}$<$ dim $>$::addToSparsityPattern (dealii::TrilinosWrappers::SparsityPattern \& {\em cSparse}, \/  const dealii::DoFHandler$<$ dim $>$ \& {\em doFHandler}) const\hspace{0.3cm}{\ttfamily  \mbox{[}inline, virtual\mbox{]}}}}
\label{classnatrium_1_1LinearFluxBoundary_a9af705258aaaa468de303848f622f9c0}


In order to include the boundary conditions into the integration we have to expand the sparsity pattern. In concrete, we have to couple blocks at the boundary that belong to different distribution functions \[ f_{\alpha} \] and \[ f_{\beta} \]. The concrete coupling depends on m\_\-pointCoupling. If this is
\begin{DoxyItemize}
\item COUPLE\_\-ONLY\_\-SINGLE\_\-POINTS: only the DoFs belonging to the same point are coupled
\item COUPLE\_\-WHOLE\_\-FACE: all DoFs at the face are coupled, e.g. if \[ \partial_{x}f_{\beta} \] is required to calculate \[ f_{\alpha} \] at the boundary. 
\end{DoxyItemize}
\begin{DoxyParams}{Parameters}
\item[{\em in/out\mbox{]}}]doFHandler the DoFHandler \end{DoxyParams}
\hypertarget{classnatrium_1_1LinearFluxBoundary_a0b050ff4bc9204ae732fec318c21cf2b}{
\index{natrium::LinearFluxBoundary@{natrium::LinearFluxBoundary}!assembleBoundary@{assembleBoundary}}
\index{assembleBoundary@{assembleBoundary}!natrium::LinearFluxBoundary@{natrium::LinearFluxBoundary}}
\subsubsection[{assembleBoundary}]{\setlength{\rightskip}{0pt plus 5cm}template$<$size\_\-t dim$>$ virtual void {\bf natrium::LinearFluxBoundary}$<$ dim $>$::assembleBoundary (size\_\-t {\em alpha}, \/  const typename dealii::DoFHandler$<$ dim $>$::active\_\-cell\_\-iterator \& {\em cell}, \/  size\_\-t {\em faceNumber}, \/  dealii::FEFaceValues$<$ dim $>$ \& {\em feFaceValues}, \/  const {\bf Stencil} \& {\em stencil}, \/  const std::map$<$ size\_\-t, size\_\-t $>$ \& {\em q\_\-index\_\-to\_\-facedof}, \/  const vector$<$ double $>$ \& {\em inverseLocalMassMatrix}, \/  distributed\_\-sparse\_\-block\_\-matrix \& {\em systemMatrix}, \/  distributed\_\-block\_\-vector \& {\em systemVector}, \/  bool {\em useCentralFlux} = {\ttfamily false}) const\hspace{0.3cm}{\ttfamily  \mbox{[}pure virtual\mbox{]}}}}
\label{classnatrium_1_1LinearFluxBoundary_a0b050ff4bc9204ae732fec318c21cf2b}


Pure virtual function for the concrete assembly of the boundary. The child classes have to override this function for each specific boundary. 
\begin{DoxyParams}{Parameters}
\item[\mbox{$\leftarrow$} {\em alpha}]The index of the distribution function  f\_\-\{\} \mbox{]} for which the boundary is constructed. \item[\mbox{$\leftarrow$} {\em cell}]The current cell (assembly is done cell-\/by-\/cell) \item[\mbox{$\leftarrow$} {\em faceNumber}]The current face number. \item[\mbox{$\leftarrow$} {\em feFaceValues}]The dealii::FEFaceValues$<$dim$>$ object, which has to be reinitialized right at the beginning of the assembleBoundary function (it can be empty, but is passed here as a function parameter to avoid construction of a new feFaceValues object). \item[\mbox{$\leftarrow$} {\em stencil}]The DQ stencil, which is required here to get the particle velocities. \item[\mbox{$\leftarrow$} {\em q\_\-index\_\-to\_\-facedof}]Maps quadrature nodes to DoFs (only possible for GLL nodes) \item[\mbox{$\leftarrow$} {\em inverseLocalMassMatrix}]\[ M^{-1} \] is multiplied with the obtained boundary matrix at the end of the assembly. \item[{\em in/out\mbox{]}}]systemMatrix The global system matrix which is assembled to. \item[{\em in/out\mbox{]}}]systemVector The global system vector which is assembled to. \item[\mbox{$\leftarrow$} {\em useCentralFlux}]indicates whether to use a central instead of a Lax-\/Friedrichs flux. Should not be used, has not been tested thoroughly and yields bad results, usually. \end{DoxyParams}


Implemented in \hyperlink{classnatrium_1_1LinearFluxBoundaryRhoU_a4572f65018de568b40f56921e8f89788}{natrium::LinearFluxBoundaryRhoU$<$ dim $>$}.

The documentation for this class was generated from the following files:\begin{DoxyCompactItemize}
\item 
/mnt/fdrive/akraem3m/workspace/NATriuM/src/library/natrium/boundaries/LinearFluxBoundary.h\item 
/mnt/fdrive/akraem3m/workspace/NATriuM/src/library/natrium/boundaries/LinearFluxBoundary.cpp\end{DoxyCompactItemize}
