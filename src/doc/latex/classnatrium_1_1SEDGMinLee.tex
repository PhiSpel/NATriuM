\hypertarget{classnatrium_1_1SEDGMinLee}{
\section{natrium::SEDGMinLee$<$ dim $>$ Class Template Reference}
\label{classnatrium_1_1SEDGMinLee}\index{natrium::SEDGMinLee@{natrium::SEDGMinLee}}
}


This class solves the linear advection equations by a scheme which is used, e.g., by Min and Lee (2011): A spectral-\/element discontinuous Galerkin lattice Boltzmann method for nearly incompressible flows, JCP 230 pp. 245-\/259. The advection equations used in the Lattice Boltzmann on unstructured grids are \[ \partial_t f_{\alpha} + e_{\alpha} \partial_x f_{\alpha} = 0,\quad \forall {\alpha} = 1,\dots,Q-1 \] where $ f_{\alpha}(x,t) $ are the particle distribution functions, and $ e_{\alpha} $ are the particle velocities. The discontinuous Galerkin (DG) method turns these PDEs into a large system of ODEs which can then be solved by a time integration scheme. Whereas this class implements the SEDG spatial discretization, the time integration is done by a subclass of \hyperlink{classnatrium_1_1TimeIntegrator}{TimeIntegrator}, e.g. \hyperlink{classnatrium_1_1RungeKutta5LowStorage}{RungeKutta5LowStorage}. In other Finite Element schemes, degrees of freedom can belong to different elements (e.g. at corners of elements). In contrast, DG methods have the degrees of freedom belonging to a single element, which can lead to discontinuities at the element faces. To connect neighbor cells, the integral over the boundary of each cell incorporates the solution on neighbor cells. These contributions are called numerical fluxes. The DG scheme uses the weak formulation of the above equations on quadrilateral elements \$\$: \[ \left( \partial_t f_{\alpha} + \partial_x (e_{\alpha} f_{\alpha}), \Phi \right)_{\Omega_e} = \left(n \left[ e_i f_{\alpha} - F^{\ast}_{\alpha}(f) \right], \Phi \right)_{\partial \Omega_e}. \] In this formulation $ F^{\ast}_{i}(f) $ denotes the numerical fluxes. They can be be calculated as central fluxes or Lax-\/Friedrichs fluxes. Lax-\/Friedrichs is in general more accurate for the advection equation. For detailed information on the fluxes, see the cited paper. For spatial integration a Gauss-\/Lobatto quadrature is used, which has the advantage that the resulting mass matrix M\_\-\{\} = (, )\_\-\{\} is diagonal. This circumvents the solution of a linear equation system. Each advection equation leads to a ODE \[ \partial_t f_{\alpha} = M_{\alpha}^{-1}(- e_{\alpha x} D_{{\alpha}x} - e_{{\alpha}y} D_{{\alpha}y} + R_{\alpha}) f_{\alpha} + B_i f_{{\alpha}^{\ast}} + b_{\alpha}.\] Altogether, for the example of the \hyperlink{classnatrium_1_1D2Q9}{D2Q9}, the system becomes \[ \partial_t f_{1,\dots,Q} = \left( \matrix{ L_1 & 0 & B_1 & 0 & 0 & 0 & 0 & 0 \cr 0 & L_2 & 0 & B_2 & 0 & 0 & 0 & 0 \cr B_3 & 0 & L_3 & 0 & 0 & 0 & 0 & 0 \cr 0 & B_4 & 0 & L_4 & 0 & 0 & 0 & 0 \cr 0 & 0 & 0 & 0 & L_5 & 0 & B_5 & 0 \cr 0 & 0 & 0 & 0 & 0 & L_6 & 0 & B_6\cr 0 & 0 & 0 & 0 & B_7 & 0 & L_7 & 0 \cr 0 & 0 & 0 & 0 & 0 & B_8 & 0 & L_8 } \right) f_{1,\dots,Q} + \left( \matrix{ b_1 \cr b_2 \cr b_3 \cr b_4 \cr b_5 \cr b_6 \cr b_7 \cr b_8 }\right), \] where $ L_{\alpha} = M_{\alpha}^{-1}(- e_{{\alpha}x} D_{{\alpha}x} - e_{{\alpha}y} D_{{\alpha}y} + R_{\alpha}) $.  


{\ttfamily \#include $<$SEDGMinLee.h$>$}Inheritance diagram for natrium::SEDGMinLee$<$ dim $>$::\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=2cm]{classnatrium_1_1SEDGMinLee}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classnatrium_1_1SEDGMinLee_a1d570e9833c6b0df01a0cd7cf3b8c905}{SEDGMinLee} (boost::shared\_\-ptr$<$ Mesh$<$ dim $>$ $>$ triangulation, boost::shared\_\-ptr$<$ \hyperlink{classnatrium_1_1BoundaryCollection}{BoundaryCollection}$<$ dim $>$ $>$ boundaries, size\_\-t orderOfFiniteElement, boost::shared\_\-ptr$<$ \hyperlink{classnatrium_1_1Stencil}{Stencil} $>$ stencil, bool useCentralFlux=false)
\begin{DoxyCompactList}\small\item\em constructor \item\end{DoxyCompactList}\item 
\hypertarget{classnatrium_1_1SEDGMinLee_a6c55a31bc4cb0e314876af7251ad8ce3}{
virtual \hyperlink{classnatrium_1_1SEDGMinLee_a6c55a31bc4cb0e314876af7251ad8ce3}{$\sim$SEDGMinLee} ()}
\label{classnatrium_1_1SEDGMinLee_a6c55a31bc4cb0e314876af7251ad8ce3}

\begin{DoxyCompactList}\small\item\em destructor \item\end{DoxyCompactList}\item 
\hypertarget{classnatrium_1_1SEDGMinLee_afc9430efe8aefc7bbe580db2302b2392}{
virtual void \hyperlink{classnatrium_1_1SEDGMinLee_afc9430efe8aefc7bbe580db2302b2392}{reassemble} ()}
\label{classnatrium_1_1SEDGMinLee_afc9430efe8aefc7bbe580db2302b2392}

\begin{DoxyCompactList}\small\item\em function to (re-\/)assemble linear system \item\end{DoxyCompactList}\item 
\hypertarget{classnatrium_1_1SEDGMinLee_a61d0a648a6a46a4fb7445c67e010f14e}{
virtual void {\bfseries setupDoFs} ()}
\label{classnatrium_1_1SEDGMinLee_a61d0a648a6a46a4fb7445c67e010f14e}

\item 
\hypertarget{classnatrium_1_1SEDGMinLee_aba8ec4263463d79479a3bbbad2f65844}{
virtual void \hyperlink{classnatrium_1_1SEDGMinLee_aba8ec4263463d79479a3bbbad2f65844}{stream} ()}
\label{classnatrium_1_1SEDGMinLee_aba8ec4263463d79479a3bbbad2f65844}

\begin{DoxyCompactList}\small\item\em make streaming step \item\end{DoxyCompactList}\item 
\hypertarget{classnatrium_1_1SEDGMinLee_adcf3f6321cbf27f6c540a6c5f21c7cb0}{
virtual const distributed\_\-sparse\_\-block\_\-matrix \& \hyperlink{classnatrium_1_1SEDGMinLee_adcf3f6321cbf27f6c540a6c5f21c7cb0}{getSystemMatrix} () const }
\label{classnatrium_1_1SEDGMinLee_adcf3f6321cbf27f6c540a6c5f21c7cb0}

\begin{DoxyCompactList}\small\item\em get global system matrix \item\end{DoxyCompactList}\item 
\hypertarget{classnatrium_1_1SEDGMinLee_ac1f5ecd80111566dd53804b6db2a1cb3}{
virtual void {\bfseries mapDoFsToSupportPoints} (std::map$<$ dealii::types::global\_\-dof\_\-index, dealii::Point$<$ dim $>$ $>$ \&supportPoints) const }
\label{classnatrium_1_1SEDGMinLee_ac1f5ecd80111566dd53804b6db2a1cb3}

\item 
\hypertarget{classnatrium_1_1SEDGMinLee_abd088667b6ff315c440d00cd0eb26840}{
virtual const boost::shared\_\-ptr$<$ dealii::DoFHandler$<$ dim $>$ $>$ \& {\bfseries getDoFHandler} () const }
\label{classnatrium_1_1SEDGMinLee_abd088667b6ff315c440d00cd0eb26840}

\item 
\hypertarget{classnatrium_1_1SEDGMinLee_a10acabaac20a992130e88fb9bd395d31}{
const dealii::BlockSparsityPattern \& {\bfseries getBlockSparsityPattern} () const }
\label{classnatrium_1_1SEDGMinLee_a10acabaac20a992130e88fb9bd395d31}

\item 
const dealii::SparsityPattern \& \hyperlink{classnatrium_1_1SEDGMinLee_ac9392932aaab8186b427b9d12bc64771}{getSparsityPattern} (size\_\-t i) const 
\begin{DoxyCompactList}\small\item\em get sparsity pattern \item\end{DoxyCompactList}\item 
\hypertarget{classnatrium_1_1SEDGMinLee_ab888ac14b8ef33ed706b5d63deea86ae}{
const dealii::MappingQ$<$ dim $>$ \& {\bfseries getMapping} () const }
\label{classnatrium_1_1SEDGMinLee_ab888ac14b8ef33ed706b5d63deea86ae}

\item 
\hypertarget{classnatrium_1_1SEDGMinLee_aec38323cbd34487a73b4f62f0a310ceb}{
virtual const std::map$<$ size\_\-t, size\_\-t $>$ \& {\bfseries getCelldofToQIndex} () const }
\label{classnatrium_1_1SEDGMinLee_aec38323cbd34487a73b4f62f0a310ceb}

\item 
\hypertarget{classnatrium_1_1SEDGMinLee_a8b7d94c90ccfa5e341d854059d883f57}{
const vector$<$ std::map$<$ size\_\-t, size\_\-t $>$ $>$ \& {\bfseries getFacedofToQIndex} () const }
\label{classnatrium_1_1SEDGMinLee_a8b7d94c90ccfa5e341d854059d883f57}

\item 
\hypertarget{classnatrium_1_1SEDGMinLee_a42897893820c9d12e9fea6f5518e3447}{
const boost::shared\_\-ptr$<$ dealii::QGaussLobatto$<$ dim-\/1 $>$ $>$ \& {\bfseries getFaceQuadrature} () const }
\label{classnatrium_1_1SEDGMinLee_a42897893820c9d12e9fea6f5518e3447}

\item 
\hypertarget{classnatrium_1_1SEDGMinLee_ab7cd0a95e74da6d4d16ab2d174b17458}{
virtual const boost::shared\_\-ptr$<$ dealii::FE\_\-DGQArbitraryNodes$<$ dim $>$ $>$ \& {\bfseries getFe} () const }
\label{classnatrium_1_1SEDGMinLee_ab7cd0a95e74da6d4d16ab2d174b17458}

\item 
\hypertarget{classnatrium_1_1SEDGMinLee_a5dac839ef4963af315dba5f201bd763c}{
virtual size\_\-t {\bfseries getNumberOfDoFsPerCell} () const }
\label{classnatrium_1_1SEDGMinLee_a5dac839ef4963af315dba5f201bd763c}

\item 
\hypertarget{classnatrium_1_1SEDGMinLee_ad36da36624c983cf84716d97442b1989}{
virtual const boost::shared\_\-ptr$<$ dealii::QGaussLobatto$<$ dim $>$ $>$ \& {\bfseries getQuadrature} () const }
\label{classnatrium_1_1SEDGMinLee_ad36da36624c983cf84716d97442b1989}

\item 
\hypertarget{classnatrium_1_1SEDGMinLee_a954e80fd9475bd4c617b573a96b5290e}{
virtual size\_\-t {\bfseries getOrderOfFiniteElement} () const }
\label{classnatrium_1_1SEDGMinLee_a954e80fd9475bd4c617b573a96b5290e}

\item 
virtual size\_\-t \hyperlink{classnatrium_1_1SEDGMinLee_af667cda1a894340f614da67c0a0ae5da}{getNumberOfDoFs} () const 
\begin{DoxyCompactList}\small\item\em save matrices and status to files \item\end{DoxyCompactList}\item 
\hypertarget{classnatrium_1_1SEDGMinLee_ac4d17489cf8bf5e98bd7bd4e3e32f0d4}{
virtual const distributed\_\-block\_\-vector \& {\bfseries getSystemVector} () const }
\label{classnatrium_1_1SEDGMinLee_ac4d17489cf8bf5e98bd7bd4e3e32f0d4}

\item 
\hypertarget{classnatrium_1_1SEDGMinLee_a790e9783ea5c3ce34b1a4e82332eda4c}{
const dealii::IndexSet \& {\bfseries getLocallyOwnedDofs} ()}
\label{classnatrium_1_1SEDGMinLee_a790e9783ea5c3ce34b1a4e82332eda4c}

\item 
\hypertarget{classnatrium_1_1SEDGMinLee_a9c47f73e0a2dcd738573b57f61da75fc}{
const dealii::IndexSet \& {\bfseries getLocallyRelevantDofs} ()}
\label{classnatrium_1_1SEDGMinLee_a9c47f73e0a2dcd738573b57f61da75fc}

\item 
\hypertarget{classnatrium_1_1SEDGMinLee_a6bb31f5b359305f3f36ec5000767c8a3}{
virtual const vector$<$ std::map$<$ size\_\-t, size\_\-t $>$ $>$ \& {\bfseries getQIndexToFacedof} () const }
\label{classnatrium_1_1SEDGMinLee_a6bb31f5b359305f3f36ec5000767c8a3}

\item 
\hypertarget{classnatrium_1_1SEDGMinLee_a23bb9307417d9626121422252dad46d9}{
virtual const boost::shared\_\-ptr$<$ Mesh$<$ dim $>$ $>$ \& {\bfseries getMesh} () const }
\label{classnatrium_1_1SEDGMinLee_a23bb9307417d9626121422252dad46d9}

\item 
\hypertarget{classnatrium_1_1SEDGMinLee_a102114aac5fa9d33a4bf7a1f70eb3ed8}{
virtual const boost::shared\_\-ptr$<$ \hyperlink{classnatrium_1_1Stencil}{Stencil} $>$ \& {\bfseries getStencil} () const }
\label{classnatrium_1_1SEDGMinLee_a102114aac5fa9d33a4bf7a1f70eb3ed8}

\item 
\hypertarget{classnatrium_1_1SEDGMinLee_ab9bdc47144e9e45960ca1bee2593d713}{
{\footnotesize template$<$$>$ }\\void {\bfseries calculateAndDistributeLocalStiffnessMatrix} (size\_\-t alpha, const vector$<$ dealii::FullMatrix$<$ double $>$ $>$ \&derivativeMatrices, dealii::FullMatrix$<$ double $>$ \&systemMatrix, const vector$<$ double $>$ \&inverseLocalMassMatrix, const std::vector$<$ dealii::types::global\_\-dof\_\-index $>$ \&globalDoFs, size\_\-t dofsPerCell)}
\label{classnatrium_1_1SEDGMinLee_ab9bdc47144e9e45960ca1bee2593d713}

\item 
\hypertarget{classnatrium_1_1SEDGMinLee_a7d20a56bbe96969ef037be2a6f47d12d}{
{\footnotesize template$<$$>$ }\\void {\bfseries calculateAndDistributeLocalStiffnessMatrix} (size\_\-t alpha, const vector$<$ dealii::FullMatrix$<$ double $>$ $>$ \&derivativeMatrices, dealii::FullMatrix$<$ double $>$ \&systemMatrix, const vector$<$ double $>$ \&inverseLocalMassMatrix, const std::vector$<$ dealii::types::global\_\-dof\_\-index $>$ \&globalDoFs, size\_\-t dofsPerCell)}
\label{classnatrium_1_1SEDGMinLee_a7d20a56bbe96969ef037be2a6f47d12d}

\end{DoxyCompactItemize}


\subsection{Detailed Description}
\subsubsection*{template$<$size\_\-t dim$>$ class natrium::SEDGMinLee$<$ dim $>$}

This class solves the linear advection equations by a scheme which is used, e.g., by Min and Lee (2011): A spectral-\/element discontinuous Galerkin lattice Boltzmann method for nearly incompressible flows, JCP 230 pp. 245-\/259. The advection equations used in the Lattice Boltzmann on unstructured grids are \[ \partial_t f_{\alpha} + e_{\alpha} \partial_x f_{\alpha} = 0,\quad \forall {\alpha} = 1,\dots,Q-1 \] where $ f_{\alpha}(x,t) $ are the particle distribution functions, and $ e_{\alpha} $ are the particle velocities. The discontinuous Galerkin (DG) method turns these PDEs into a large system of ODEs which can then be solved by a time integration scheme. Whereas this class implements the SEDG spatial discretization, the time integration is done by a subclass of \hyperlink{classnatrium_1_1TimeIntegrator}{TimeIntegrator}, e.g. \hyperlink{classnatrium_1_1RungeKutta5LowStorage}{RungeKutta5LowStorage}. In other Finite Element schemes, degrees of freedom can belong to different elements (e.g. at corners of elements). In contrast, DG methods have the degrees of freedom belonging to a single element, which can lead to discontinuities at the element faces. To connect neighbor cells, the integral over the boundary of each cell incorporates the solution on neighbor cells. These contributions are called numerical fluxes. The DG scheme uses the weak formulation of the above equations on quadrilateral elements \$\$: \[ \left( \partial_t f_{\alpha} + \partial_x (e_{\alpha} f_{\alpha}), \Phi \right)_{\Omega_e} = \left(n \left[ e_i f_{\alpha} - F^{\ast}_{\alpha}(f) \right], \Phi \right)_{\partial \Omega_e}. \] In this formulation $ F^{\ast}_{i}(f) $ denotes the numerical fluxes. They can be be calculated as central fluxes or Lax-\/Friedrichs fluxes. Lax-\/Friedrichs is in general more accurate for the advection equation. For detailed information on the fluxes, see the cited paper. For spatial integration a Gauss-\/Lobatto quadrature is used, which has the advantage that the resulting mass matrix M\_\-\{\} = (, )\_\-\{\} is diagonal. This circumvents the solution of a linear equation system. Each advection equation leads to a ODE \[ \partial_t f_{\alpha} = M_{\alpha}^{-1}(- e_{\alpha x} D_{{\alpha}x} - e_{{\alpha}y} D_{{\alpha}y} + R_{\alpha}) f_{\alpha} + B_i f_{{\alpha}^{\ast}} + b_{\alpha}.\] Altogether, for the example of the \hyperlink{classnatrium_1_1D2Q9}{D2Q9}, the system becomes \[ \partial_t f_{1,\dots,Q} = \left( \matrix{ L_1 & 0 & B_1 & 0 & 0 & 0 & 0 & 0 \cr 0 & L_2 & 0 & B_2 & 0 & 0 & 0 & 0 \cr B_3 & 0 & L_3 & 0 & 0 & 0 & 0 & 0 \cr 0 & B_4 & 0 & L_4 & 0 & 0 & 0 & 0 \cr 0 & 0 & 0 & 0 & L_5 & 0 & B_5 & 0 \cr 0 & 0 & 0 & 0 & 0 & L_6 & 0 & B_6\cr 0 & 0 & 0 & 0 & B_7 & 0 & L_7 & 0 \cr 0 & 0 & 0 & 0 & 0 & B_8 & 0 & L_8 } \right) f_{1,\dots,Q} + \left( \matrix{ b_1 \cr b_2 \cr b_3 \cr b_4 \cr b_5 \cr b_6 \cr b_7 \cr b_8 }\right), \] where $ L_{\alpha} = M_{\alpha}^{-1}(- e_{{\alpha}x} D_{{\alpha}x} - e_{{\alpha}y} D_{{\alpha}y} + R_{\alpha}) $. 
\begin{DoxyTemplParams}{Template Parameters}
\item[{\em dim}]The dimension of the flow (2 or 3). \end{DoxyTemplParams}


\subsection{Constructor \& Destructor Documentation}
\hypertarget{classnatrium_1_1SEDGMinLee_a1d570e9833c6b0df01a0cd7cf3b8c905}{
\index{natrium::SEDGMinLee@{natrium::SEDGMinLee}!SEDGMinLee@{SEDGMinLee}}
\index{SEDGMinLee@{SEDGMinLee}!natrium::SEDGMinLee@{natrium::SEDGMinLee}}
\subsubsection[{SEDGMinLee}]{\setlength{\rightskip}{0pt plus 5cm}template$<$size\_\-t dim$>$ {\bf natrium::SEDGMinLee}$<$ dim $>$::{\bf SEDGMinLee} (boost::shared\_\-ptr$<$ Mesh$<$ dim $>$ $>$ {\em triangulation}, \/  boost::shared\_\-ptr$<$ {\bf BoundaryCollection}$<$ dim $>$ $>$ {\em boundaries}, \/  size\_\-t {\em orderOfFiniteElement}, \/  boost::shared\_\-ptr$<$ {\bf Stencil} $>$ {\em stencil}, \/  bool {\em useCentralFlux} = {\ttfamily false})\hspace{0.3cm}{\ttfamily  \mbox{[}inline\mbox{]}}}}
\label{classnatrium_1_1SEDGMinLee_a1d570e9833c6b0df01a0cd7cf3b8c905}


constructor Constructor 
\begin{DoxyParams}{Parameters}
\item[\mbox{$\leftarrow$} {\em triangulation}]The global mesh. \item[\mbox{$\leftarrow$} {\em orderOfFiniteElement}]The number of nodes element and dimension \item[\mbox{$\leftarrow$} {\em stencil}]the DQ model \end{DoxyParams}


\subsection{Member Function Documentation}
\hypertarget{classnatrium_1_1SEDGMinLee_af667cda1a894340f614da67c0a0ae5da}{
\index{natrium::SEDGMinLee@{natrium::SEDGMinLee}!getNumberOfDoFs@{getNumberOfDoFs}}
\index{getNumberOfDoFs@{getNumberOfDoFs}!natrium::SEDGMinLee@{natrium::SEDGMinLee}}
\subsubsection[{getNumberOfDoFs}]{\setlength{\rightskip}{0pt plus 5cm}template$<$size\_\-t dim$>$ virtual size\_\-t {\bf natrium::SEDGMinLee}$<$ dim $>$::getNumberOfDoFs () const\hspace{0.3cm}{\ttfamily  \mbox{[}inline, virtual\mbox{]}}}}
\label{classnatrium_1_1SEDGMinLee_af667cda1a894340f614da67c0a0ae5da}


save matrices and status to files 
\begin{DoxyParams}{Parameters}
\item[\mbox{$\leftarrow$} {\em directory}]directory to save the matrix files to \end{DoxyParams}

\begin{DoxyExceptions}{Exceptions}
\item[{\em \hyperlink{classnatrium_1_1AdvectionSolverException}{AdvectionSolverException}}]\end{DoxyExceptions}


Implements \hyperlink{classnatrium_1_1AdvectionOperator_a251e21d1dd023926d4c5f7fd973b90bf}{natrium::AdvectionOperator$<$ dim $>$}.\hypertarget{classnatrium_1_1SEDGMinLee_ac9392932aaab8186b427b9d12bc64771}{
\index{natrium::SEDGMinLee@{natrium::SEDGMinLee}!getSparsityPattern@{getSparsityPattern}}
\index{getSparsityPattern@{getSparsityPattern}!natrium::SEDGMinLee@{natrium::SEDGMinLee}}
\subsubsection[{getSparsityPattern}]{\setlength{\rightskip}{0pt plus 5cm}template$<$size\_\-t dim$>$ const dealii::SparsityPattern\& {\bf natrium::SEDGMinLee}$<$ dim $>$::getSparsityPattern (size\_\-t {\em i}) const\hspace{0.3cm}{\ttfamily  \mbox{[}inline\mbox{]}}}}
\label{classnatrium_1_1SEDGMinLee_ac9392932aaab8186b427b9d12bc64771}


get sparsity pattern \begin{DoxyNote}{Note}
not available for trilinos, as trilinos has an internal format for sparsity patterns (Epetra\_\-CrsGraph) 
\end{DoxyNote}


The documentation for this class was generated from the following files:\begin{DoxyCompactItemize}
\item 
/mnt/fdrive/akraem3m/workspace/NATriuM/src/library/natrium/advection/\hyperlink{SEDGMinLee_8h}{SEDGMinLee.h}\item 
/mnt/fdrive/akraem3m/workspace/NATriuM/src/library/natrium/advection/\hyperlink{SEDGMinLee_8cpp}{SEDGMinLee.cpp}\end{DoxyCompactItemize}
