\hypertarget{classnatrium_1_1matrixAnalysis}{
\section{natrium::matrixAnalysis$<$ dim $>$ Class Template Reference}
\label{classnatrium_1_1matrixAnalysis}\index{natrium::matrixAnalysis@{natrium::matrixAnalysis}}
}


Calculation of spectra and pseudospectra of streaming matrices.  


{\ttfamily \#include $<$matrixAnalysis.h$>$}\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hypertarget{classnatrium_1_1matrixAnalysis_a2adce3a150d6a284ade9dfb4474f1c95}{
{\bfseries matrixAnalysis} (boost::shared\_\-ptr$<$ \hyperlink{classnatrium_1_1CFDSolver}{CFDSolver}$<$ dim $>$ $>$ solver)}
\label{classnatrium_1_1matrixAnalysis_a2adce3a150d6a284ade9dfb4474f1c95}

\item 
void \hyperlink{classnatrium_1_1matrixAnalysis_ae774e069b53034a25ed633f789af625e}{writeSpectrum} (bool scale\_\-by\_\-timestep)
\begin{DoxyCompactList}\small\item\em Write the spectrum of the CFDSolver's streaming matrix to the file spectrum.txt in the OutputDirectory. \item\end{DoxyCompactList}\item 
void \hyperlink{classnatrium_1_1matrixAnalysis_a9e9739f9d9181cc8b294bcbeca96df68}{writePseudospectrum} (bool scale\_\-by\_\-timestep, size\_\-t numberOfCycles=10, double perturbation=0.1)
\begin{DoxyCompactList}\small\item\em Write the pseudospectrum of the CFDSolver's streaming matrix to the file pseudospectrum.txt in the OutputDirectory. The pseudospectrum contains the eigenvalues of all matrices that are \char`\"{}close to the matrix A\char`\"{}, i.e. all entries can be perturbed by a small number. \item\end{DoxyCompactList}\item 
\hypertarget{classnatrium_1_1matrixAnalysis_a1ff55d84b26542fd69daecd377e97b73}{
{\footnotesize template$<$$>$ }\\{\bfseries matrixAnalysis} (boost::shared\_\-ptr$<$ \hyperlink{classnatrium_1_1CFDSolver}{CFDSolver}$<$ 2 $>$ $>$ solver)}
\label{classnatrium_1_1matrixAnalysis_a1ff55d84b26542fd69daecd377e97b73}

\item 
\hypertarget{classnatrium_1_1matrixAnalysis_abdfe6261017b6fc18bb6abe9c89d24d6}{
{\footnotesize template$<$$>$ }\\{\bfseries matrixAnalysis} (boost::shared\_\-ptr$<$ \hyperlink{classnatrium_1_1CFDSolver}{CFDSolver}$<$ 3 $>$ $>$ solver)}
\label{classnatrium_1_1matrixAnalysis_abdfe6261017b6fc18bb6abe9c89d24d6}

\end{DoxyCompactItemize}
\subsection*{Static Public Member Functions}
\begin{DoxyCompactItemize}
\item 
static double \hyperlink{classnatrium_1_1matrixAnalysis_a03a05223c2dc32a674f8b3ec2f6e6659}{computeSpectrum} (const distributed\_\-sparse\_\-block\_\-matrix \&matrix, vector$<$ std::complex$<$ double $>$ $>$ \&eigenvalues, double perturbation=0.0)
\begin{DoxyCompactList}\small\item\em Compute the eigenvalues of a sparse block matrix. \item\end{DoxyCompactList}\item 
\hypertarget{classnatrium_1_1matrixAnalysis_a964e7ba2af5b8f105b82d4ce56f314da}{
static double {\bfseries computeSpectrum} (dealii::LAPACKFullMatrix$<$ double $>$ \&matrix, vector$<$ std::complex$<$ double $>$ $>$ \&eigenvalues, double perturbation=0.0)}
\label{classnatrium_1_1matrixAnalysis_a964e7ba2af5b8f105b82d4ce56f314da}

\end{DoxyCompactItemize}


\subsection{Detailed Description}
\subsubsection*{template$<$size\_\-t dim$>$ class natrium::matrixAnalysis$<$ dim $>$}

Calculation of spectra and pseudospectra of streaming matrices. 

\subsection{Member Function Documentation}
\hypertarget{classnatrium_1_1matrixAnalysis_a03a05223c2dc32a674f8b3ec2f6e6659}{
\index{natrium::matrixAnalysis@{natrium::matrixAnalysis}!computeSpectrum@{computeSpectrum}}
\index{computeSpectrum@{computeSpectrum}!natrium::matrixAnalysis@{natrium::matrixAnalysis}}
\subsubsection[{computeSpectrum}]{\setlength{\rightskip}{0pt plus 5cm}template$<$size\_\-t dim$>$ template double {\bf natrium::matrixAnalysis}$<$ dim $>$::computeSpectrum (const distributed\_\-sparse\_\-block\_\-matrix \& {\em matrix}, \/  vector$<$ std::complex$<$ double $>$ $>$ \& {\em eigenvalues}, \/  double {\em perturbation} = {\ttfamily 0.0})\hspace{0.3cm}{\ttfamily  \mbox{[}inline, static\mbox{]}}}}
\label{classnatrium_1_1matrixAnalysis_a03a05223c2dc32a674f8b3ec2f6e6659}


Compute the eigenvalues of a sparse block matrix. 
\begin{DoxyParams}{Parameters}
\item[{\em matrix}]the matrix \item[{\em eigenvalues}]Vector of eigenvalues. Is automatically resized by the method. \item[{\em perturbation}]Can be used to perturb all matrix entries by a random number in the interval \mbox{[}-\/perturbation, perturbation\mbox{]}. This is required for the calculation of pseudospectra. Default: 0.0 (no perturbation). \end{DoxyParams}
\begin{DoxyNote}{Note}
Only practicable for small matrices, as the sparse matrix is turned into a full matrix. 
\end{DoxyNote}
\begin{DoxyReturn}{Returns}
maximum of absolute eigenvalues 
\end{DoxyReturn}
\hypertarget{classnatrium_1_1matrixAnalysis_a9e9739f9d9181cc8b294bcbeca96df68}{
\index{natrium::matrixAnalysis@{natrium::matrixAnalysis}!writePseudospectrum@{writePseudospectrum}}
\index{writePseudospectrum@{writePseudospectrum}!natrium::matrixAnalysis@{natrium::matrixAnalysis}}
\subsubsection[{writePseudospectrum}]{\setlength{\rightskip}{0pt plus 5cm}template$<$size\_\-t dim$>$ template void {\bf natrium::matrixAnalysis}$<$ dim $>$::writePseudospectrum (bool {\em scale\_\-by\_\-timestep}, \/  size\_\-t {\em numberOfCycles} = {\ttfamily 10}, \/  double {\em perturbation} = {\ttfamily 0.1})\hspace{0.3cm}{\ttfamily  \mbox{[}inline\mbox{]}}}}
\label{classnatrium_1_1matrixAnalysis_a9e9739f9d9181cc8b294bcbeca96df68}


Write the pseudospectrum of the CFDSolver's streaming matrix to the file pseudospectrum.txt in the OutputDirectory. The pseudospectrum contains the eigenvalues of all matrices that are \char`\"{}close to the matrix A\char`\"{}, i.e. all entries can be perturbed by a small number. 
\begin{DoxyParams}{Parameters}
\item[{\em numberOfCycles}]The number of matrices \char`\"{}close to A\char`\"{}, whose eigenvalues will be calculated. Default: 10. \item[{\em perturbation}]Maximal perturbation of the matrix entries. Default: 0.1. \end{DoxyParams}
\begin{DoxyNote}{Note}
If the output directory does not exist: Write to /tmp/NATrium\_\-pseudospectrum.txt 
\end{DoxyNote}
\hypertarget{classnatrium_1_1matrixAnalysis_ae774e069b53034a25ed633f789af625e}{
\index{natrium::matrixAnalysis@{natrium::matrixAnalysis}!writeSpectrum@{writeSpectrum}}
\index{writeSpectrum@{writeSpectrum}!natrium::matrixAnalysis@{natrium::matrixAnalysis}}
\subsubsection[{writeSpectrum}]{\setlength{\rightskip}{0pt plus 5cm}template$<$size\_\-t dim$>$ template void {\bf natrium::matrixAnalysis}$<$ dim $>$::writeSpectrum (bool {\em scale\_\-by\_\-timestep})\hspace{0.3cm}{\ttfamily  \mbox{[}inline\mbox{]}}}}
\label{classnatrium_1_1matrixAnalysis_ae774e069b53034a25ed633f789af625e}


Write the spectrum of the CFDSolver's streaming matrix to the file spectrum.txt in the OutputDirectory. \begin{DoxyNote}{Note}
If the output directory does not exist: Write to /tmp/NATrium\_\-spectrum.txt 

The result differs from the spectrum in Min and Lees Paper, because we consider here the full streaming matrix, which includes all streaming directions. 
\end{DoxyNote}


The documentation for this class was generated from the following files:\begin{DoxyCompactItemize}
\item 
/mnt/fdrive/akraem3m/workspace/NATriuM/src/analysis/matrix-\/analysis/\hyperlink{matrixAnalysis_8h}{matrixAnalysis.h}\item 
/mnt/fdrive/akraem3m/workspace/NATriuM/src/analysis/matrix-\/analysis/\hyperlink{matrixAnalysis_8cpp}{matrixAnalysis.cpp}\end{DoxyCompactItemize}
